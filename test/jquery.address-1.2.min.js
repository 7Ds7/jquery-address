/*
 * jQuery Address Plugin v1.2
 * http://www.asual.com/jquery/address/
 *
 * Copyright (c) 2009-2010 Rostislav Hristov
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * Date: 2010-04-21 23:54:54 +0300 (Wed, 21 Apr 2010)
 */
(function(c){c.address=function(){var t=function(a){c(c.address).trigger(c.extend(c.Event(a),function(){for(var b={},g=c.address.parameterNames(),h=0,q=g.length;h<q;h++)b[g[h]]=c.address.parameter(g[h]);return{value:c.address.value(),path:c.address.path(),pathNames:c.address.pathNames(),parameterNames:g,parameters:b,queryString:c.address.queryString()}}.call(c.address)))},u=function(a,b,g){if(g||b)c(c.address).bind(a,g||b,g&&b);return c.address},o=function(){var a=d.href.indexOf("#");return a!=-1?
W(J(v(d.href.substr(a+1),k))):""},X=function(){return"javascript"},Y=function(a,b){if(i.strict)a=b?a.substr(0,1)!="/"?"/"+a:a:a==""?"/":a;return a},K=function(a,b){return w&&d.protocol=="file:"?b?f.replace(/\?/,"%3F"):f.replace(/%253F/,"?"):a},v=function(a,b){if(i.crawlable&&b)return(a!=""?"!":"")+a;return a.replace(/^\!/,"")},x=function(a,b){return parseInt(a.css(b),10)},Z=function(a){for(var b,g,h=0,q=a.childNodes.length;h<q;h++){if(a.childNodes[h].src)b=String(a.childNodes[h].src);if(g=Z(a.childNodes[h]))b=
g}return b},H=function(){if(!L){var a=o(),b=f!=a;if(y&&n<523){if(D!=F.length){D=F.length;if(typeof z[D-1]!=A)f=z[D-1];G(k)}}else if(w&&n<7&&b)d.reload();else if(b){f=a;G(k)}}},G=function(a){t($);t(a?aa:ba);E(ca,10)},ca=function(){var a=(d.pathname+(/\/$/.test(d.pathname)?"":"/")+(c.address?c.address.value():"")).replace(/\/\//,"/").replace(/^\/$/,""),b=window[i.tracker];if(typeof j[b]==M)j[b](a);else if(typeof j.urchinTracker==M)j.urchinTracker(a);else if(typeof j.pageTracker!=A&&typeof j.pageTracker._trackPageview==
M)j.pageTracker._trackPageview(a);else typeof j._gaq!=A&&typeof j._gaq.push==M&&j._gaq.push(["_trackPageview",a])},da=function(){var a=m.contentWindow.document;a.open();a.write("<html><head><title>"+l.title+"</title><script>var "+p+' = "'+o()+'";<\/script></head></html>');a.close()},fa=function(){if(!ea){ea=e;if(i.wrap){var a=c("body");wrap=c("body > *").wrapAll('<div style="padding:'+(x(a,"marginTop")+x(a,"paddingTop"))+"px "+(x(a,"marginRight")+x(a,"paddingRight"))+"px "+(x(a,"marginBottom")+x(a,
"paddingBottom"))+"px "+(x(a,"marginLeft")+x(a,"paddingLeft"))+'px;" />').parent().wrap('<div id="'+p+'" style="height:100%; overflow:auto;'+(y?window.statusbar.visible&&!/chrome/i.test(O)?"":" resize:both;":"")+'" />');c("html, body").css({height:"100%",margin:0,padding:0,overflow:"hidden"});y&&c('<style type="text/css" />').appendTo("head").text("#"+p+"::-webkit-resizer { background-color: #fff; }")}if(w&&n<8){a=l.getElementsByTagName("frameset")[0];m=l.createElement((a?"":"i")+"frame");if(a){a.insertAdjacentElement("beforeEnd",
m);a[a.cols?"cols":"rows"]+=",0";m.src=X()+":"+k;m.noResize=e;m.frameBorder=m.frameSpacing=0}else{m.src=X()+":"+k;m.style.display="none";l.body.insertAdjacentElement("afterBegin",m)}E(function(){c(m).bind("load",function(){var b=m.contentWindow;f=typeof b[p]!=A?b[p]:"";if(f!=o()){G(k);d.hash=K(v(f,e),e)}});typeof m.contentWindow[p]==A&&da()},50)}else if(y){if(n<418){c(l.body).append('<form id="'+p+'" style="position:absolute;top:-9999px;" method="get"></form>');P=l.getElementById(p)}if(typeof d[p]==
A)d[p]={};if(typeof d[p][d.pathname]!=A)z=d[p][d.pathname].split(",")}E(function(){t("init");G(k)},1);if(w&&n>7||!w&&"on"+I in j)if(j.addEventListener)j.addEventListener(I,H,false);else j.attachEvent&&j.attachEvent("on"+I,H);else ja(H,50);c("a").filter("[rel*=address:]").address()}},ka=function(){if(j.removeEventListener)j.removeEventListener(I,H,false);else j.detachEvent&&j.detachEvent("on"+I,H)},p="jQueryAddress",M="function",A="undefined",I="hashchange",$="change",aa="internalChange",ba="externalChange",
e=true,k=false,i={autoUpdate:e,crawlable:k,history:e,strict:e,wrap:k},r=c.browser,n=parseFloat(c.browser.version),ga=r.mozilla,w=r.msie,s=r.opera,y=r.safari,Q=k,j=function(){try{return top.document!==undefined?top:window}catch(a){return window}}(),l=j.document,F=j.history,d=j.location,ja=setInterval,E=setTimeout,J=decodeURI,W=encodeURI,O=navigator.userAgent,m,P,B=Z(document),ha=B?B.indexOf("?"):-1,R=l.title,D=F.length,L=k,ea=k,S=e,ia=e,N=k,z=[],f=o();if(w){n=parseFloat(O.substr(O.indexOf("MSIE")+
4));if(l.documentMode&&l.documentMode!=n)n=l.documentMode!=8?7:8;c(document).bind("propertychange",function(){if(l.title!=R&&l.title.indexOf("#"+o())!=-1)l.title=R})}if(Q=ga&&n>=1||w&&n>=6||s&&n>=9.5||y&&n>=312){for(r=1;r<D;r++)z.push("");z.push(f);if(w&&d.hash!=f)d.hash="#"+K(v(f,e),e);if(s)history.navigationMode="compatible";if(B&&ha!=-1){B=B.substr(ha+1).split("&");for(r=0;r<B.length;r++){s=B[r].split("=");if(/^(autoUpdate|crawlable|history|strict|wrap)$/.test(s[0]))i[s[0]]=isNaN(s[1])?/^(true|yes)$/i.test(s[1]):
parseInt(s[1],10)!==0;if(/^tracker$/.test(s[0]))i[s[0]]=s[1]}}document.readyState=="complete"&&fa();c(fa);c(window).bind("unload",ka)}else if(!Q&&o()!=""||y&&n<418&&o()!=""&&d.search!=""){l.open();l.write('<html><head><meta http-equiv="refresh" content="0;url='+encodeURI(d.href.substr(0,d.href.indexOf("#")))+'" /></head></html>');l.close()}else ca();return{init:function(a,b){return u("init",a,b)},change:function(a,b){return u($,a,b)},internalChange:function(a,b){return u(aa,a,b)},externalChange:function(a,
b){return u(ba,a,b)},baseURL:function(){var a=d.href;if(o()!="")a=a.substr(0,a.indexOf("#"));if(/\/$/.test(a))a=a.substr(0,a.length-1);return a},autoUpdate:function(a){if(a!==undefined){i.autoUpdate=a;return this}return i.autoUpdate},crawlable:function(a){if(a!==undefined){i.crawlable=a;return this}return i.crawlable},history:function(a){if(a!==undefined){i.history=a;return this}return i.history},strict:function(a){if(a!==undefined){i.strict=a;return this}return i.strict},tracker:function(a){if(a!==
undefined){i.tracker=a;return this}return i.tracker},wrap:function(a){if(a!==undefined){i.wrap=a;return this}return i.wrap},update:function(){N=e;this.value(f);N=k;return this},title:function(a){if(a!==undefined){a=J(a);E(function(){R=l.title=a;if(ia&&m&&m.contentWindow&&m.contentWindow.document){m.contentWindow.document.title=a;ia=k}if(!S&&ga)d.replace(d.href.indexOf("#")!=-1?d.href:d.href+"#");S=k},50);return this}return l.title},value:function(a){if(a!==undefined){a=W(J(Y(a,e)));if(a=="/")a="";
if(f==a&&!N)return;S=e;f=a;if(i.autoUpdate||N){L=e;G(e);z[F.length]=f;if(y)if(i.history){d[p][d.pathname]=z.toString();D=F.length+1;if(n<418){if(d.search==""){P.action="#"+v(f,e);P.submit()}}else if(n<523||f==""){a=l.createEvent("MouseEvents");a.initEvent("click",e,e);var b=l.createElement("a");b.href="#"+v(f,e);b.dispatchEvent(a)}else d.hash="#"+v(f,e)}else d.replace("#"+v(f,e));else if(f!=o())if(i.history)d.hash="#"+K(v(f,e),e);else d.replace("#"+v(f,e));w&&n<8&&i.history&&E(da,50);if(y)E(function(){L=
k},1);else L=k}return this}if(!Q)return null;return J(Y(K(f,k),k))},path:function(a){if(a!==undefined){var b=this.queryString(),g=this.hash();this.value(a+(b?"?"+b:"")+(g?"#"+g:""));return this}return this.value().split("#")[0].split("?")[0]},queryString:function(a){if(a!==undefined){var b=this.hash();this.value(this.path()+(a?"?"+a:"")+(b?"#"+b:""));return this}a=this.value().split("?");return a.slice(1,a.length).join("?").split("#")[0]},parameter:function(a,b,g){var h,q;if(b!==undefined){var T=
this.parameterNames();q=[];for(h=0;h<T.length;h++){var U=T[h],C=this.parameter(U);if(typeof C=="string")C=[C];if(U==a)C=b===null||b==""?[]:g?C.concat([b]):[b];for(var V=0;V<C.length;V++)q.push(U+"="+C[V])}c.inArray(a,T)==-1&&b!==null&&b!=""&&q.push(a+"="+b);this.queryString(q.join("&"));return this}if(b=this.queryString()){q=b.split("&");b=[];for(h=0;h<q.length;h++){g=q[h].split("=");g[0]==a&&b.push(g[1])}if(b.length!==0)return b.length!=1?b:b[0]}},pathNames:function(){var a=this.path(),b=a.replace(/\/{2,9}/g,
"/").split("/");if(a.substr(0,1)=="/"||a.length===0)b.splice(0,1);a.substr(a.length-1,1)=="/"&&b.splice(b.length-1,1);return b},parameterNames:function(){var a=this.queryString(),b=[];if(a&&a.indexOf("=")!=-1){a=a.split("&");for(var g=0;g<a.length;g++){var h=a[g].split("=")[0];c.inArray(h,b)==-1&&b.push(h)}}return b},hash:function(a){if(a!==undefined){this.value(this.value().split("#")[0]+(a?"#"+a:""));return this}a=this.value().split("#");return a.slice(1,a.length).join("#")}}}();c.fn.address=function(t){var u=
function(){if(c(this).is("a")){var o=t?t.call(this):/address:/.test(c(this).attr("rel"))?c(this).attr("rel").split("address:")[1].split(" ")[0]:c(this).attr("href").replace(/^#\!?/,"");c.address.value(o);return false}};c(this).click(u).live("click",u);c(this).live("submit",function(){if(c(this).is("form")){var o=t?t.call(this):c(this).attr("action")+"?"+c(this).serialize();c.address.value(o);return false}});return this};c.fn.crawlable=function(){var t=top.location.pathname.replace(/\/$/,"");c(this).each(function(){var u=
c(this).attr("href").replace(new RegExp(t+"/?$"),"");c(this).attr("href","#"+decodeURIComponent(u.replace(/(.*)\?_escaped_fragment_=(.*)$/,"!$2")))});return this}})(jQuery);
