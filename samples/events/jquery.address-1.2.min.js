/*
 * jQuery Address Plugin v1.2
 * http://www.asual.com/jquery/address/
 *
 * Copyright (c) 2009-2010 Rostislav Hristov
 * Dual licensed under the MIT and GPL licenses.
 * http://docs.jquery.com/License
 *
 * Date: 2010-02-23 00:42:34 +0200 (Tue, 23 Feb 2010)
 */
(function(d){d.address=function(){var z=function(a){d(d.address).trigger(d.extend(d.Event(a),function(){for(var b={},g=d.address.parameterNames(),e=0,n=g.length;e<n;e++)b[g[e]]=d.address.parameter(g[e]);return{value:d.address.value(),path:d.address.path(),pathNames:d.address.pathNames(),parameterNames:g,parameters:b,queryString:d.address.queryString()}}.call(d.address)))},u=function(a,b,g){if(g||b)d(d.address).bind(a,g||b,g&&b);return d.address},q=function(){var a=c.href.indexOf("#");return a!=-1?
R(F(c.href.substr(a+1))):""},S=function(a,b){if(k.strict)a=b?a.substr(0,1)!="/"?"/"+a:a:a==""?"/":a;return a},G=function(a,b){return t&&c.protocol=="file:"?b?f.replace(/\?/,"%3F"):f.replace(/%253F/,"?"):a},T=function(a){for(var b,g,e=0,n=a.childNodes.length;e<n;e++){if(a.childNodes[e].src)b=String(a.childNodes[e].src);if(g=T(a.childNodes[e]))b=g}return b},U=function(){if(!H){var a=q(),b=f!=a;if(A&&l<523){if(B!=D.length){B=D.length;if(typeof v[B-1]!=w)f=v[B-1];E(m)}}else if(t&&l<7&&b)c.reload();else if(b){f=
a;E(m)}}},E=function(a){z("change");z(a?"internalChange":"externalChange");C(V,10)},V=function(){var a=(c.pathname+(/\/$/.test(c.pathname)?"":"/")+d.address.value()).replace(/\/\//,"/").replace(/^\/$/,""),b=window[k.tracker];if(typeof b==I)b(a);else if(typeof _gaq!=w&&typeof _gaq.push==I)_gaq.push(["_trackPageview",a]);else if(typeof pageTracker!=w&&typeof pageTracker._trackPageview==I)pageTracker._trackPageview(a);else typeof urchinTracker==I&&urchinTracker(a)},W=function(){var a=i.contentWindow.document;
a.open();a.write("<html><head><title>"+h.title+"</title><script>var "+o+' = "'+q()+'";<\/script></head></html>');a.close()},L=function(){if(!X){X=j;if(t&&l<8){var a=h.getElementsByTagName("frameset")[0];i=h.createElement((a?"":"i")+"frame");if(a){a.insertAdjacentElement("beforeEnd",i);a[a.cols?"cols":"rows"]+=",0";i.src="javascript:false";i.noResize=j;i.frameBorder=i.frameSpacing=0}else{i.src="javascript:false";i.style.display="none";h.body.insertAdjacentElement("afterBegin",i)}C(function(){d(i).bind("load",
function(){var b=i.contentWindow;f=typeof b[o]!=w?b[o]:"";if(f!=q()){E(m);c.hash=G(f,j)}});typeof i.contentWindow[o]==w&&W()},50)}else if(A){if(l<418){d(h.body).append('<form id="'+o+'" style="position:absolute;top:-9999px;" method="get"></form>');K=h.getElementById(o)}if(typeof c[o]==w)c[o]={};if(typeof c[o][c.pathname]!=w)v=c[o][c.pathname].split(",")}C(function(){z("init");E(m)},1);if(t&&l>=8)h.body.onhashchange=U;else aa(U,50);d("a[rel*=address:]").address()}},o="jQueryAddress",I="function",w=
"undefined",j=true,m=false,r=d.browser,l=parseFloat(d.browser.version),Y=r.mozilla,t=r.msie,p=r.opera,A=r.safari,M=m;r=function(){try{return top.document!==undefined?top:window}catch(a){return window}}();var h=r.document,D=r.history,c=r.location,aa=setInterval,C=setTimeout,F=decodeURI,R=encodeURI,s=navigator.userAgent,i,K,x=T(document),Z=x?x.indexOf("?"):-1,ba=h.title,B=D.length,H=m,X=m,N=j,$=j,J=m,v=[],f=q(),k={autoUpdate:j,history:j,strict:j};if(t){l=parseFloat(s.substr(s.indexOf("MSIE")+4));if(h.documentMode&&
h.documentMode!=l)l=h.documentMode!=8?7:8}if(M=Y&&l>=1||t&&l>=6||p&&l>=9.5||A&&l>=312){for(s=1;s<B;s++)v.push("");v.push(q());if(t&&c.hash!=q())c.hash="#"+G(q(),j);if(p)history.navigationMode="compatible";if(x&&Z!=-1){x=x.substr(Z+1).split("&");for(s=0;s<x.length;s++){p=x[s].split("=");if(/^(autoUpdate|history|strict)$/.test(p[0]))k[p[0]]=isNaN(p[1])?/^(true|yes)$/i.test(p[1]):parseInt(p[1],10)!==0;if(/^tracker$/.test(p[0]))k[p[0]]=p[1]}}if(h.readyState=="complete")L();else{window==r&&d(L);d(r).load(L)}}else if(!M&&
c.href.indexOf("#")!=-1||A&&l<418&&c.href.indexOf("#")!=-1&&c.search!=""){h.open();h.write('<html><head><meta http-equiv="refresh" content="0;url='+c.href.substr(0,c.href.indexOf("#"))+'" /></head></html>');h.close()}else V();return{init:function(a,b){return u("init",a,b)},change:function(a,b){return u("change",a,b)},internalChange:function(a,b){return u("internalChange",a,b)},externalChange:function(a,b){return u("externalChange",a,b)},baseURL:function(){var a=c.href;if(a.indexOf("#")!=-1)a=a.substr(0,
a.indexOf("#"));if(a.substr(a.length-1)=="/")a=a.substr(0,a.length-1);return a},strict:function(a){if(a!==undefined){k.strict=a;return this}return k.strict},autoUpdate:function(a){if(a!==undefined){k.autoUpdate=a;return this}return k.autoUpdate},update:function(){J=j;this.value(f);J=m;return this},history:function(a){if(a!==undefined){k.history=a;return this}return k.history},tracker:function(a){if(a!==undefined){k.tracker=a;return this}return k.tracker},title:function(a){if(a!==undefined){a=F(a);
C(function(){ba=h.title=a;if($&&i&&i.contentWindow&&i.contentWindow.document){i.contentWindow.document.title=a;$=m}if(!N&&Y)c.replace(c.href.indexOf("#")!=-1?c.href:c.href+"#");N=m},50);return this}return h.title},value:function(a){if(a!==undefined){a=R(F(S(a,j)));if(a=="/")a="";if(f==a&&!J)return;N=j;f=a;if(k.autoUpdate||J){H=j;E(j);v[D.length]=f;if(A)if(k.history){c[o][c.pathname]=v.toString();B=D.length+1;if(l<418){if(c.search==""){K.action="#"+f;K.submit()}}else if(l<523||f==""){a=h.createEvent("MouseEvents");
a.initEvent("click",j,j);var b=h.createElement("a");b.href="#"+f;b.dispatchEvent(a)}else c.hash="#"+f}else c.replace("#"+f);else if(f!=q())if(k.history)c.hash="#"+G(f,j);else c.replace("#"+f);t&&l<8&&k.history&&C(W,50);if(A)C(function(){H=m},1);else H=m}return this}if(!M)return null;return F(S(G(f,m),m))},path:function(a){if(a!==undefined){var b=this.queryString();this.value(a+(b?"?"+b:""));return this}a=this.value();return a.indexOf("?")!=-1?a.split("?")[0]:a},queryString:function(a){if(a!==undefined){this.value(this.path()+
(a?"?"+a:""));return this}a=this.value();var b=a.indexOf("?");if(b!=-1&&b<a.length)return a.substr(b+1)},parameter:function(a,b,g){var e,n;if(b!==undefined){var O=this.parameterNames();n=[];for(e=0;e<O.length;e++){var P=O[e],y=this.parameter(P);if(typeof y=="string")y=[y];if(P==a)y=b===null||b==""?[]:g?y.concat([b]):[b];for(var Q=0;Q<y.length;Q++)n.push(P+"="+y[Q])}d.inArray(a,O)==-1&&n.push(a+"="+b);this.queryString(n.join("&"));return this}b=this.value();e=b.indexOf("?");if(e!=-1){b=b.substr(e+
1);n=b.split("&");b=[];for(e=0;e<n.length;e++){g=n[e].split("=");g[0]==a&&b.push(g[1])}if(b.length!==0)return b.length!=1?b:b[0]}},pathNames:function(){var a=this.path(),b=a.split("/");if(a.substr(0,1)=="/"||a.length===0)b.splice(0,1);a.substr(a.length-1,1)=="/"&&b.splice(b.length-1,1);return b},parameterNames:function(){var a=this.value(),b=a.indexOf("?"),g=[];if(b!=-1){a=a.substr(b+1);if(a!=""&&a.indexOf("=")!=-1){a=a.split("&");for(b=0;b<a.length;b++){var e=a[b].split("=")[0];d.inArray(e,g)==-1&&
g.push(e)}}}return g}}}();d.fn.address=function(z){var u=function(){var q=z?z.call(this):/address:/.test(d(this).attr("rel"))?d(this).attr("rel").split("address:")[1].split(" ")[0]:d(this).attr("href").replace(/^#/,"");d.address.value(q);return false};d(this).click(u).live("click",u)}})(jQuery);
